<!-- InstAnalytics - Modern Instagram Analytics -->
<Window x:Class="InstAnalytics.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:InstAnalytics"
        xmlns:ScottPlot="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
        mc:Ignorable="d"
        Title="InstAnalytics - Instagram Analytics"
        Height="600" Width="1000"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="CanResize"
        WindowStartupLocation="CenterScreen"
        Icon="app_icon.ico">

    <Window.Resources>
        <!-- Converters -->
        <local:NullToBooleanConverter x:Key="NullToBooleanConverter"/>
        <local:GrowthTrendColorConverter x:Key="GrowthTrendColorConverter"/>

        <!-- Color Palette -->
        <SolidColorBrush x:Key="PrimaryBackgroundBrush" Color="#1A1A2E"/>
        <SolidColorBrush x:Key="SecondaryBackgroundBrush" Color="#16213E"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#E94560"/>
        <SolidColorBrush x:Key="AccentHoverBrush" Color="#FF5770"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#EAEAEA"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#A0A0A0"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#2A2A3E"/>
        <!-- Glassmorphism colors - highly transparent -->
        <SolidColorBrush x:Key="CardBackgroundBrush" Color="#BF16213E"/>
        <SolidColorBrush x:Key="GlassBorderBrush" Color="#80FFFFFF"/>
        <SolidColorBrush x:Key="GlassBackgroundBrush" Color="#BF16213E"/>

        <!-- Button Style for Window Controls -->
        <Style x:Key="WindowButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="46"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2A2A3E"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Close Button Style (Red hover) -->
        <Style x:Key="CloseButtonStyle" TargetType="Button" BasedOn="{StaticResource WindowButtonStyle}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Tab Control Style -->
        <Style x:Key="ModernTabControl" TargetType="TabControl">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>

        <!-- Tab Item Style -->
        <Style x:Key="ModernTabItem" TargetType="TabItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                BorderThickness="0,0,0,3"
                                BorderBrush="Transparent"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter x:Name="ContentSite"
                                            ContentSource="Header"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#1F1F30"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card Style with Glassmorphism Effect -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource GlassBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="30" ShadowDepth="4"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentHoverBrush}"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Icon Button Style (no hover effect) -->
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Opacity" Value="0.7"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Dark Button Style with Glassmorphism Effect -->
        <Style x:Key="DarkButton" TargetType="Button">
            <Setter Property="Background" Value="#BF252538"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{StaticResource GlassBorderBrush}"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="12"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="30" ShadowDepth="4"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#D92F2F45"/>
                    <Setter Property="BorderBrush" Value="#CCFFFFFF"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.4"/>
                    <Setter Property="Cursor" Value="Arrow"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!-- Main Border with rounded corners and shadow -->
    <Border Background="{StaticResource PrimaryBackgroundBrush}"
            CornerRadius="12"
            BorderThickness="1"
            BorderBrush="{StaticResource BorderBrush}">
        <Border.Effect>
            <DropShadowEffect Color="#000000" Opacity="0.5" BlurRadius="20" ShadowDepth="0"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="50"/>
                <!-- Title Bar -->
                <RowDefinition Height="*"/>
                <!-- Content -->
                <RowDefinition Height="Auto"/>
                <!-- Footer -->
            </Grid.RowDefinitions>

            <!-- Custom Title Bar with Glass Effect -->
            <Border Grid.Row="0"
                    Background="{StaticResource GlassBackgroundBrush}"
                    BorderBrush="{StaticResource GlassBorderBrush}"
                    BorderThickness="0,0,0,1"
                    CornerRadius="12,12,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- App Title and Icon -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                        <Image Source="app_icon.ico" Width="20" Height="20" Margin="0,0,10,0"/>
                        <TextBlock Text="InstAnalytics"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Foreground="{StaticResource TextPrimaryBrush}"
                                   VerticalAlignment="Center"/>
                        <TextBlock Text="Instagram Analytics"
                                   FontSize="12"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   VerticalAlignment="Center"
                                   Margin="10,0,0,0"/>
                    </StackPanel>

                    <!-- Window Controls -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button Style="{StaticResource WindowButtonStyle}"
                                Click="MinimizeButton_Click"
                                Content="â”€"
                                FontSize="16"/>
                        <Button Style="{StaticResource CloseButtonStyle}"
                                Click="CloseButton_Click"
                                Content="âœ•"
                                FontSize="16"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Main Content Area -->
            <TabControl Grid.Row="1"
                        Style="{StaticResource ModernTabControl}"
                        Background="Transparent">

                <!-- Tab: Analisi -->
                <TabItem Header="Analisi" Style="{StaticResource ModernTabItem}">
                    <Grid Background="{StaticResource PrimaryBackgroundBrush}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="20">
                                <!-- Welcome Header -->
                                <TextBlock Text="Analisi Instagram"
                                           FontSize="22"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           Margin="0,0,0,8"/>
                                <TextBlock Text="Carica il file ZIP esportato da Instagram per analizzare followers e following"
                                           FontSize="13"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           Margin="0,0,0,20"/>

                                <!-- ZIP File Selection Card -->
                                <Border Style="{StaticResource CardStyle}" HorizontalAlignment="Center" MinWidth="500">
                                    <StackPanel>
                                        <Grid Margin="0,0,0,12">
                                            <TextBlock Text="ðŸ“¦ File ZIP Instagram"
                                                       FontSize="18"
                                                       FontWeight="SemiBold"
                                                       Foreground="{StaticResource TextPrimaryBrush}"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                                            <Button HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Style="{StaticResource IconButton}"
                                                    Padding="8"
                                                    Click="InfoButton_Click"
                                                    ToolTip="Come esportare i dati da Instagram">
                                                <Image Source="info_icon.png" Width="24" Height="24"/>
                                            </Button>
                                        </Grid>
                                        <TextBox x:Name="ZipFileTextBox"
                                                 Background="#BF1A1A2E"
                                                 Foreground="{StaticResource TextPrimaryBrush}"
                                                 BorderBrush="{StaticResource GlassBorderBrush}"
                                                 BorderThickness="1"
                                                 Padding="10"
                                                 FontSize="12"
                                                 IsReadOnly="True"
                                                 Text="Nessun file selezionato"
                                                 Margin="0,0,0,12"
                                                 TextAlignment="Center"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,0">
                                            <Button Content="ðŸ“‚ Seleziona File ZIP"
                                                    Style="{StaticResource DarkButton}"
                                                    Click="SelectZipFile_Click"
                                                    Padding="20,12"
                                                    FontSize="14"
                                                    Margin="0,0,10,0"/>
                                            <Button x:Name="AnalyzeButton"
                                                    Content="âœ¨ Avvia"
                                                    Style="{StaticResource DarkButton}"
                                                    Click="AnalyzeButton_Click"
                                                    IsEnabled="False"
                                                    Padding="20,12"
                                                    FontSize="14"
                                                    Background="#92140C"
                                                    BorderBrush="#92140C"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Results Section -->
                                <Border x:Name="ResultsCard"
                                        Style="{StaticResource CardStyle}"
                                        Visibility="Collapsed">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“Š Risultati Analisi"
                                                   FontSize="18"
                                                   FontWeight="Bold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"
                                                   Margin="0,0,0,15"/>

                                        <!-- Results Grid - Row 1: Totals -->
                                        <Grid Margin="0,0,0,10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Margin="8" HorizontalAlignment="Center">
                                                <TextBlock Text="ðŸ‘¥ Followers Totali"
                                                           FontSize="12"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="TotalFollowersCountText"
                                                           Text="0"
                                                           FontSize="28"
                                                           FontWeight="Bold"
                                                           Foreground="#4ECCA3"
                                                           Margin="0,4,0,0"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1" Margin="8" HorizontalAlignment="Center">
                                                <TextBlock Text="ðŸ”” Following Totali"
                                                           FontSize="12"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="TotalFollowingCountText"
                                                           Text="0"
                                                           FontSize="28"
                                                           FontWeight="Bold"
                                                           Foreground="#FFD93D"
                                                           Margin="0,4,0,0"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Grid>

                                        <!-- Results Grid - Row 2: Analysis -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0" Margin="8" HorizontalAlignment="Center">
                                                <TextBlock Text="Non ti seguono"
                                                           FontSize="12"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="NotFollowingBackCountText"
                                                           Text="0"
                                                           FontSize="28"
                                                           FontWeight="Bold"
                                                           Foreground="{StaticResource AccentBrush}"
                                                           Margin="0,4,0,0"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="1" Margin="8" HorizontalAlignment="Center">
                                                <TextBlock Text="Non segui"
                                                           FontSize="12"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="NotFollowingCountText"
                                                           Text="0"
                                                           FontSize="28"
                                                           FontWeight="Bold"
                                                           Foreground="#4ECCA3"
                                                           Margin="0,4,0,0"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>

                                            <StackPanel Grid.Column="2" Margin="8" HorizontalAlignment="Center">
                                                <TextBlock Text="Followers reciproci"
                                                           FontSize="12"
                                                           Foreground="{StaticResource TextSecondaryBrush}"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock x:Name="MutualFollowersCountText"
                                                           Text="0"
                                                           FontSize="28"
                                                           FontWeight="Bold"
                                                           Foreground="#FFD93D"
                                                           Margin="0,4,0,0"
                                                           HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Grid>

                                        <!-- User Lists -->
                                        <TabControl Margin="0,15,0,0"
                                                    Background="Transparent"
                                                    BorderThickness="0">
                                            <TabItem Header="Non ti seguono" Style="{StaticResource ModernTabItem}">
                                                <ListBox x:Name="NotFollowingBackListBox"
                                                         Background="#BF1A1A2E"
                                                         Foreground="{StaticResource TextPrimaryBrush}"
                                                         BorderBrush="{StaticResource GlassBorderBrush}"
                                                         BorderThickness="1"
                                                         MaxHeight="250"
                                                         FontSize="12"
                                                         Margin="0,8,0,0"/>
                                            </TabItem>
                                            <TabItem Header="Non segui" Style="{StaticResource ModernTabItem}">
                                                <ListBox x:Name="NotFollowingListBox"
                                                         Background="#BF1A1A2E"
                                                         Foreground="{StaticResource TextPrimaryBrush}"
                                                         BorderBrush="{StaticResource GlassBorderBrush}"
                                                         BorderThickness="1"
                                                         MaxHeight="250"
                                                         FontSize="12"
                                                         Margin="0,8,0,0"/>
                                            </TabItem>
                                            <TabItem Header="Followers reciproci" Style="{StaticResource ModernTabItem}">
                                                <ListBox x:Name="MutualFollowersListBox"
                                                         Background="#BF1A1A2E"
                                                         Foreground="{StaticResource TextPrimaryBrush}"
                                                         BorderBrush="{StaticResource GlassBorderBrush}"
                                                         BorderThickness="1"
                                                         MaxHeight="250"
                                                         FontSize="12"
                                                         Margin="0,8,0,0"/>
                                            </TabItem>
                                        </TabControl>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </TabItem>

                <!-- Tab: Statistiche -->
                <TabItem Header="Statistiche" Style="{StaticResource ModernTabItem}">
                    <Grid Background="{StaticResource PrimaryBackgroundBrush}">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="20">
                                <TextBlock Text="Storico Analisi"
                                           FontSize="22"
                                           FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           Margin="0,0,0,8"/>
                                <TextBlock Text="Visualizza l'andamento storico dei tuoi followers e following"
                                           FontSize="13"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           Margin="0,0,0,20"/>

                                <!-- Overview Cards -->
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0" Style="{StaticResource CardStyle}">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“Š Analisi Totali"
                                                       FontSize="12"
                                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock Text="{Binding StatisticsViewModel.TotalAnalyses}"
                                                       FontSize="28"
                                                       FontWeight="Bold"
                                                       Foreground="{StaticResource AccentBrush}"
                                                       Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="1" Style="{StaticResource CardStyle}">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ‘¥ Followers Attuali"
                                                       FontSize="12"
                                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock Text="{Binding StatisticsViewModel.CurrentFollowers}"
                                                       FontSize="28"
                                                       FontWeight="Bold"
                                                       Foreground="#4ECCA3"
                                                       Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="2" Style="{StaticResource CardStyle}">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ”” Following Attuali"
                                                       FontSize="12"
                                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock Text="{Binding StatisticsViewModel.CurrentFollowing}"
                                                       FontSize="28"
                                                       FontWeight="Bold"
                                                       Foreground="#FFD93D"
                                                       Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </Border>

                                    <Border Grid.Column="3" Style="{StaticResource CardStyle}">
                                        <StackPanel>
                                            <TextBlock Text="ðŸ“ˆ Trend Crescita"
                                                       FontSize="12"
                                                       Foreground="{StaticResource TextSecondaryBrush}"/>
                                            <TextBlock Text="{Binding StatisticsViewModel.GrowthTrend}"
                                                       FontSize="28"
                                                       FontWeight="Bold"
                                                       Foreground="{Binding StatisticsViewModel.GrowthTrendValue, Converter={StaticResource GrowthTrendColorConverter}}"
                                                       Margin="0,4,0,0"/>
                                        </StackPanel>
                                    </Border>
                                </Grid>

                                <!-- Trends Chart -->
                                <Border Style="{StaticResource CardStyle}" Margin="0,0,0,20">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“ˆ Andamento Followers e Following"
                                                   FontSize="16"
                                                   FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimaryBrush}"
                                                   Margin="0,0,0,15"/>
                                        <ScottPlot:WpfPlot x:Name="TrendsChart"
                                                           Height="300"
                                                           Background="#BF1A1A2E"/>
                                    </StackPanel>
                                </Border>

                                <!--  Historical Data Grid (Collapsible) -->
                                <Border Style="{StaticResource CardStyle}">
                                    <Expander IsExpanded="False">
                                        <Expander.Header>
                                            <Grid>
                                                <TextBlock Text="ðŸ“Š Storico Analisi"
                                                           FontSize="16"
                                                           FontWeight="SemiBold"
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Expander.Header>
                                        <Expander.Style>
                                            <Style TargetType="Expander">
                                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                <Setter Property="Background" Value="Transparent"/>
                                            </Style>
                                        </Expander.Style>
                                        <StackPanel Margin="0,10,0,0">
                                            <Button Content="ðŸ—‘ï¸ Elimina Analisi Selezionata"
                                                    Style="{StaticResource ModernButton}"
                                                    Click="DeleteAnalysis_Click"
                                                    HorizontalAlignment="Right"
                                                    Padding="12,8"
                                                    FontSize="12"
                                                    Margin="0,0,0,10"
                                                    Background="#8B0000"
                                                    IsEnabled="{Binding ElementName=HistoricalDataGrid, Path=SelectedItem, Converter={StaticResource NullToBooleanConverter}}"/>
                                            <DataGrid x:Name="HistoricalDataGrid"
                                                      AutoGenerateColumns="False"
                                                      IsReadOnly="True"
                                                      Background="#BF1A1A2E"
                                                      Foreground="{StaticResource TextPrimaryBrush}"
                                                      BorderBrush="{StaticResource GlassBorderBrush}"
                                                      BorderThickness="1"
                                                      GridLinesVisibility="None"
                                                      HeadersVisibility="Column"
                                                      RowBackground="#BF16213E"
                                                      AlternatingRowBackground="#D916213E"
                                                      MaxHeight="400"
                                                      SelectionMode="Single">
                                                <DataGrid.ColumnHeaderStyle>
                                                    <Style TargetType="DataGridColumnHeader">
                                                        <Setter Property="Background" Value="#BF16213E"/>
                                                        <Setter Property="Foreground" Value="White"/>
                                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                                        <Setter Property="Padding" Value="10,8"/>
                                                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                                        <Setter Property="BorderBrush" Value="{StaticResource GlassBorderBrush}"/>
                                                    </Style>
                                                </DataGrid.ColumnHeaderStyle>
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Data" Binding="{Binding Timestamp, StringFormat=dd/MM/yyyy HH:mm}" Width="150"/>
                                                    <DataGridTextColumn Header="Followers" Binding="{Binding FollowersCount}" Width="*"/>
                                                    <DataGridTextColumn Header="Following" Binding="{Binding FollowingCount}" Width="*"/>
                                                    <DataGridTextColumn Header="Rapporto" Binding="{Binding Ratio, StringFormat=F2}" Width="*"/>
                                                </DataGrid.Columns>
                                            </DataGrid>
                                        </StackPanel>
                                    </Expander>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </TabItem>
            </TabControl>

            <!-- Info Modal Overlay -->
            <Grid x:Name="InfoModalOverlay"
                  Grid.Row="0"
                  Grid.RowSpan="3"
                  Background="#CC000000"
                  Visibility="Collapsed"
                  MouseLeftButtonDown="CloseModal_Click">
                <Border Background="{StaticResource CardBackgroundBrush}"
                        BorderBrush="{StaticResource GlassBorderBrush}"
                        BorderThickness="1"
                        CornerRadius="16"
                        MaxWidth="700"
                        MaxHeight="600"
                        Padding="30"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        MouseLeftButtonDown="ModalContent_Click">
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Opacity="0.3" BlurRadius="40" ShadowDepth="0"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Modal Header -->
                        <Grid Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock Text="ðŸ“‹ Come Esportare i Dati da Instagram"
                                       FontSize="20"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimaryBrush}"
                                       HorizontalAlignment="Center"/>
                            <Button HorizontalAlignment="Right"
                                    VerticalAlignment="Top"
                                    Style="{StaticResource IconButton}"
                                    Content="âœ•"
                                    FontSize="20"
                                    Foreground="{StaticResource TextPrimaryBrush}"
                                    Padding="8"
                                    Click="CloseModal_Click"/>
                        </Grid>

                        <!-- Modal Content -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <TextBlock Text="Per esportare i dati completi da Instagram, segui queste configurazioni:"
                                           FontSize="14"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextWrapping="Wrap"
                                           Margin="0,0,0,15"/>

                                <!-- Instructions List -->
                                <Border Background="#BF1A1A2E"
                                        BorderBrush="{StaticResource GlassBorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="15"
                                        Margin="0,0,0,15">
                                    <StackPanel>
                                        <TextBlock FontSize="13" Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap" Margin="0,0,0,8">
                                            <Run Text="1. " FontWeight="Bold"/>
                                            <Run Text="Personalizza informazioni:" FontWeight="SemiBold"/>
                                            <Run Text=" Follower e persone/Pagine seguite"/>
                                        </TextBlock>
                                        <TextBlock FontSize="13" Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap" Margin="0,0,0,8">
                                            <Run Text="2. " FontWeight="Bold"/>
                                            <Run Text="Intervallo di date:" FontWeight="SemiBold"/>
                                            <Run Text=" Sempre"/>
                                        </TextBlock>
                                        <TextBlock FontSize="13" Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap" Margin="0,0,0,8">
                                            <Run Text="3. " FontWeight="Bold"/>
                                            <Run Text="Formato:" FontWeight="SemiBold"/>
                                            <Run Text=" JSON"/>
                                        </TextBlock>
                                        <TextBlock FontSize="13" Foreground="{StaticResource TextPrimaryBrush}" TextWrapping="Wrap">
                                            <Run Text="4. " FontWeight="Bold"/>
                                            <Run Text="QualitÃ  dei contenuti multimediali:" FontWeight="SemiBold"/>
                                            <Run Text=" QualitÃ  media (o qualsiasi altra)"/>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>

                                <!-- Screenshot -->
                                <TextBlock Text="Esempio di configurazione:"
                                           FontSize="14"
                                           FontWeight="SemiBold"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           Margin="0,0,0,10"/>
                                <Border BorderBrush="{StaticResource GlassBorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Margin="0,0,0,15">
                                    <Image Source="export_instructions.jpg"
                                           Stretch="Uniform"
                                           MaxHeight="300"/>
                                </Border>

                                <TextBlock Text="Una volta completata l'esportazione, Instagram ti invierÃ  un link per scaricare il file ZIP. Scarica il file e caricalo nell'applicazione."
                                           FontSize="13"
                                           Foreground="{StaticResource TextSecondaryBrush}"
                                           TextWrapping="Wrap"
                                           FontStyle="Italic"/>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Modal Footer -->
                        <Button Grid.Row="2"
                                Content="Ho Capito"
                                Style="{StaticResource ModernButton}"
                                Click="CloseModal_Click"
                                HorizontalAlignment="Center"
                                Margin="0,20,0,0"
                                Padding="30,12"/>
                    </Grid>
                </Border>
            </Grid>

            <!-- Footer with Glass Effect -->
            <Border Grid.Row="2"
                    Background="{StaticResource GlassBackgroundBrush}"
                    BorderBrush="{StaticResource GlassBorderBrush}"
                    BorderThickness="0,1,0,0"
                    CornerRadius="0,0,12,12"
                    Padding="10,8">
                <TextBlock Text="v1.0.0 Designed by Fabio d'Agostino"
                           FontSize="11"
                           Foreground="{StaticResource TextSecondaryBrush}"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"/>
            </Border>
        </Grid>
    </Border>
</Window>
